<!DOCTYPE html []>
<html>

<head>
  <meta charset="UTF-8" />
  <title>Список изменений Admin Loader</title>
  <style type="text/css">
    td,
    h1,
    h2,
    h3,
    h4,
    h5,
    p,
    ul,
    ol,
    li {
      page-break-inside: avoid;
    }
  </style>
</head>

<body>
  <h3 id="section">Версия 3.5.0 (29 янв 2023 г):</h3>
  <h4 id="section-1">Добавлено:</h4>
  <ul>
    <li>добавлен квар al_db_encrypted_password, который определяет зашифрован пароль (1)<br />
      или нет (0) в базе данных<br />
      Внимание: не шифрует пароль, а лишь задает как плагину воспринимать полученный<br />
      из базы данных пароль</li>
    <li>добавлен квар al_user_ini_encrypted_password, который определяет зашифрован<br />
      пароль (1) или нет (0) в users.ini<br />
      Внимание: не шифрует пароль, а лишь задает как плагину воспринимать полученный<br />
      из users.ini пароль</li>
    <li>автоматическое создание 'users.ini', если был удален</li>
  </ul>
  <h4 id="section-2">Исправлено:</h4>
  <ul>
    <li>не загружались данные из 'users.ini', если не было указано время окончания услуги</li>
    <li>не работал аргумент remove_flags в native функции al_set_user_flags</li>
    <li>загруженный бэкап базы данных (addons/amxmodx/data/users.bkp), сохранялся в<br />
      users.ini при определенных условиях</li>
  </ul>
  <h4 id="section-3">Обновившиеся файлы:</h4>
  <ul>
    <li>addons/amxmodx/plugins/admin_loader.amxx</li>
    <li>addons/amxmodx/configs/admin_loader.cfg</li>
  </ul>
  <h3 id="section-4">Версия 3.4.1 (24 ноя 2021 г):</h3>
  <h4 id="section-5">Исправлено:</h4>
  <ul>
    <li>не был изменен Lang файл для перехода на ядро плагинов Plugins Core</li>
  </ul>
  <h3 id="section-6">Версия 3.4.0 (20 ноя 2021 г):</h3>
  <h4 id="section-7">Добавлено:</h4>
  <ul>
    <li>добавлена команда al_md5, которая хеширует пароль (или любую строку) с помощью<br />
      алгоритма хеширования MD5</li>
    <li>пароль в users.ini должен быть в виде MD5 хеша. Многие владельцы серверов часто<br />
      дают доступ своим заместителям, настройщикам сервера, авторам плагинов. Это<br />
      небезопасно и чревато утечкой паролей игроков.</li>
  </ul>
  <h4 id="section-8">Изменено:</h4>
  <ul>
    <li>изменен код под внешнее ядро плагинов (plugins_core.amxx)</li>
    <li>при загрузке аккаунтов из users.ini если пароль не хеширован в логах будет<br />
      предупреждение</li>
    <li>проверка хешированного пароля теперь регистронезависима</li>
  </ul>
  <h4 id="section-9">Исправлено:</h4>
  <ul>
    <li>исправлено отключение и удаление истекших аккаунтов</li>
  </ul>
  <h4 id="section-10">Обновившиеся файлы:</h4>
  <ul>
    <li>addons/amxmodx/plugins/admin_loader.amxx</li>
  </ul>
  <h3 id="section-11">Версия 3.3.5 (06 апр 2021 г):</h3>
  <h4 id="section-12">Добавлено:</h4>
  <ul>
    <li>добавлена расширенная версия команды 'amx_who'. Отличие от оригинала в<br />
      дополнительном столбце 'Info', в котором содержится информация об аккаунте:
      <ul>
        <li>при загрузке из базы данных MySQL в этом столбце будет поле nickname (которое<br />
          не меняется и задано на сайте через который добавлялся аккаунт), что позволит<br />
          идентифицировать игрока даже если он сменил ник</li>
        <li>при загрузке через users.ini будет загружена причина добавления (аргумент<br />
          reason функции al_set_user_flags)</li>
      </ul>
    </li>
    <li>добавлен новый account flag 'n', который указывает что паролем игрока является<br />
      его steamid.<br />
      Это позволяет создавать аккаунты с авторизацией nickname + steamid ('an')</li>
  </ul>
  <h4 id="section-13">Изменено:</h4>
  <ul>
    <li>бэкап аккаунтов, загруженных из базы данных MySQL, теперь хранится в файле<br />
      'addons/amxmodx/data/users.bkp'</li>
    <li>users.ini возвращена оригинальная функциональность, теперь это не бэкап файл,<br />
      а дополнительное хранилище аккаунтов, добавленных вручную или плагинами</li>
    <li>расширена функциональность native функции 'al_set_user_flags'. Если authid<br />
      (5-ый аргумент) не пустой, то произойдет запись аккаунта в файл users.ini с<br />
      указанием причины из аргумента reason (6-ой аргумент). По истечению времени<br />
      действия аккаунта, он будет автоматически удален из файла.</li>
  </ul>
  <pre><code>      /**
        * @ param player                  индекс игрока
        * @ param flags                   битсумма выдаваемых флагов доступа
        * @ param remove_flags            убрать (1) или нет (0) перед выдачей текущие
        *                                 флаги игрока
        * @ param access_expire_timestamp UTC время окончания выданных флагов доступа
        * @ param authid                  steamid игрока. Если указан, то флаги будут
        *                                 сохранены в users.ini
        * @ param reason                  причины выдачи флагов доступа. Отображается 
        *                                 в логах и в выводе команды amx_who
        *
        * @ noreturn
      */

      native al_set_user_flags(player, flags, remove_flags = 0, access_expire_timestamp, authid[AUTH_LEN], reason[128]);</code></pre>
  <h4 id="section-14">Исправлено:</h4>
  <ul>
    <li>исправлена редкая ошибка невалидного Array handle</li>
  </ul>
  <h3 id="section-15">Версия 3.3.2 (03 сен 2019 г):</h3>
  <h4 id="section-16">Исправлено:</h4>
  <ul>
    <li>исправлена остановка плагина при ошибке кэширования данных (недочеты оригинала)</li>
  </ul>
  <h3 id="section-17">Версия 3.3.1 (31 мар 2018 г):</h3>
  <h4 id="section-18">Добавлено:</h4>
  <ul>
    <li>реклама в консоли игрока при подключении</li>
    <li>в функцию al_set_user_flags, добавлен четвертый параметр access_expire_timestamp,<br />
      который позволяет задать время истечения выдаваемых флагов доступа. Прототип<br />
      функции выглядит теперь так:</li>
  </ul>
  <pre><code>      native al_set_user_flags(index, flags, remove_flags = 0, access_expire_timestamp = 0);</code></pre>
  <ul>
    <li>добавлено запоминание флагов доступа выданных через native функцию al_set_user_flags,<br />
      теперь они не сбрасываются после перезагрузки с помощью команды amx_reloadadmins</li>
    <li>добавлен квар al_reload_flags_freq, отвечающий за частоту (в минутах) перезагрузки<br />
      флагов доступа. Пригодится если привилегии продаются в автоматическом режиме.<br />
      Если значение 0, то функция отключена</li>
    <li>добавлена native функция al_set_user_flags(index, flags, remove_flags = 0);,<br />
      которая является расширенной версией стандартной функции set_user_flags.<br />
      Расширенная версия может обнулять флаги перед установкой новых, а также запускает<br />
      форварды, сообщая другим плагинам что произошло изменение прав доступа</li>
    <li>добавлена проверка срока прав доступа в режиме реального времени (с точностью<br />
      до минуты)</li>
    <li>добавлена возможность загружать несколько аккаунтов для одного игрока. Данная<br />
      возможность позволит делить права доступа на группы с разным сроком<br />
      Внимание: время когда истекает текущий набор флагов, определяется по наименьшему.<br />
      Как только истечет время, произойдет пересмотр прав доступа и время истечения<br />
      обновится, опять же по наименьшему из оставшихся</li>
  </ul>
  <h4 id="section-19">Изменено:</h4>
  <ul>
    <li>значение квара amx_default_access, теперь не кэшируется, чтобы была возможность<br />
      динамически менять значение квара (например для реализации VIP привилегий на ночь)</li>
    <li>в users.ini дата окончания теперь сохраняется в понятном для человека формате<br />
      (ранее были просто цифры timestamp)</li>
  </ul>
  <h4 id="section-20">Исправлено:</h4>
  <ul>
    <li>исправлен недочет оригинального плагина: при загрузке из файла, хранилище<br />
      загруженных прав доступа не обнулялось</li>
    <li>исправлен недочет оригинального плагина: ошибки при попытке вызова команды<br />
      amx_reloadadmins если не было связи с сервером и сервер переключился на<br />
      загрузку из файла</li>
    <li>исправлен недочет: не обнулялся Handle после теста соединения из-за введенных<br />
      для безопасности дополнительных условий</li>
  </ul>
  <h3 id="section-21">Версия 3.2.0 (15 фев 2018 г):</h3>
  <h4 id="section-22">Добавлено:</h4>
  <ul>
    <li>new добавлена native функция adminload_get_expired для совместимости с плагинами,<br />
      которые были написаны для Admin Load от F@nt0M</li>
    <li>добавлены native функция amxbans_get_expired и forward функция<br />
      amxbans_admin_connect для совместимости с плагинами, которые были написаны для<br />
      AMXBans RBS (fungun.net)</li>
    <li>добавлена возможность загрузки админов из users.ini (без базы данных), но с<br />
      возможностью задавать время окончания прав доступа. По истечению срока,<br />
      просроченная запись не загружается, вместо этого создается лог информирующий о<br />
      том что имеются просроченные аккаунты</li>
    <li>добавлена поддержка стандартных флагов авторизации b (тег клана) и k<br />
      (чувствительность к регистру)</li>
    <li>в users.ini, который создается после backup'а, добавлена стандартная памятка<br />
      по работе с флагами доступа</li>
    <li>плагин теперь использует ядро плагинов версии 1.0.3 (конфиги, мультиязычность<br />
      и т.д)</li>
  </ul>
  <h4 id="section-23">Исправлено:</h4>
  <ul>
    <li>улучшено определение установленной бан системы. Так как в оригинальном плагине<br />
      проверялось только наличие конфига от бан системы, а самого плагина могло и<br />
      не быть, либо он мог быть отключен</li>
    <li>исправлен недочет интеграции ядра плагинов</li>
    <li>исправлен недочет с форвардами, в результате чего в плагинах использующих не<br />
      загружались флаги доступа</li>
  </ul>
  <h4 id="section-24">Удалено:</h4>
  <ul>
    <li>удалена native функция al_get_access, так как она повторяет функциональность<br />
      стандартной native функции get_user_flags</li>
  </ul>
</body>

</html>