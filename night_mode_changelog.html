<!DOCTYPE html []>
<html>

<head>
  <meta charset="UTF-8" />
  <title>Список изменений Night Mode</title>
  <style type="text/css">
    td,
    h1,
    h2,
    h3,
    h4,
    h5,
    p,
    ul,
    ol,
    li {
      page-break-inside: avoid;
    }
  </style>
</head>

<body>
  <h3 id="section">1.7.0 (30 июн 2024г):</h3>
  <h4 id="section-1">Добавлено:</h4>
  <ul>
    <li>добавлен квар nm_hud_informer_default_state, который определяет будет (1) или<br />
      нет (0) показываться информер по умолчанию</li>
    <li>добавлен квар nm_hud_informer_toggle_cmd, отвечающий за список команд<br />
      (разделенных ';'), с помощью которых включается/отключается отображение информера</li>
    <li>добавлена возможность кастомизации информера. Настраивается в 'lang/night_mode.txt'</li>
  </ul>
  <pre><code>      ; Список контекстно-зависимых аргументов для HUD информеров:
      ; [map] - имя карты текущего интервала
      ; [start_time] - время начала текущего интервала
      ; [end_time] - время конца текущего интервала
      ; [left_time] - время, оставшееся до конца текущего интервала
      ; [next_map] - имя карты следующего интервала
      ; [next_start_time] - время начала следующего интервала
      ; [next_end_time] - время конца следующего интервала
      ; [next_left_time] - время, оставшееся до начала следующего интервала</code></pre>
  <h4 id="section-2">Обновившиеся файлы:</h4>
  <ul>
    <li>addons/amxmodx/plugins/night_mode.amxx</li>
    <li>addons/amxmodx/configs/night_mode.cfg</li>
    <li>addons/amxmodx/data/lang/night_mode.txt</li>
  </ul>
  <h3 id="section-3">1.6.0 (25 янв 2024г):</h3>
  <h4 id="section-4">Добавлено:</h4>
  <ul>
    <li>добавлен квар nm_timelimit_offset, определяющий на сколько секунд 'mp_timelimit'<br />
      будет больше времени окончания интервала. Пригодится в случае если голосование<br />
      за смену карты, начинается раньше чем заканчивается интервал</li>
    <li>добавлена команда:</li>
  </ul>
  <pre><code>      // nm_block_cmd_reset - позволяет очистить список команд, заблокированных
      //   командой nm_block_cmd
      // Формат команды:
      //   nm_block_cmd_reset</code></pre>
  <ul>
    <li>добавлены форварды:</li>
  </ul>
  <pre><code>      /**
      * Форвард функция вызывается при старте очередного интервала ночного режима.
      *
      * @noreturn
      */

      forward nm_interval_started();

      /**
       * Форвард функция вызывается в конце текущего интервала ночного режима.
       *
       * @noreturn
       */

      forward nm_interval_ended();</code></pre>
  <h4 id="section-5">Изменено:</h4>
  <ul>
    <li>переделана блокировка команд:
      <ul>
        <li>теперь неважна позиция плагина, в котором зарегистрирована блокируемая<br />
          команда</li>
        <li>динамическое отключение блокировки команд без необходимости смены карты</li>
      </ul>
    </li>
    <li>команде nm_block_cmd добавлено описание</li>
    <li>команде nm_block_cmd добавлен аргумент 'cmd_args' (см nigt_mode.cfg)</li>
  </ul>
  <h4 id="section-6">Исправлено:</h4>
  <ul>
    <li>квар 'mp_timelimit' изменялся, даже если изначально он был равен 0</li>
    <li>список плагинов обнулялся после выполнения конфига конца интервала</li>
    <li>длина имени плагина в команде 'nm_load_plugin' была ограничена 31 символом</li>
    <li>длина имени команды в команде 'nm_block_cmd' была ограничена 31 символом</li>
  </ul>
  <h4 id="section-7">Обновившиеся файлы:</h4>
  <ul>
    <li>addons/amxmodx/plugins/night_mode.amxx</li>
    <li>addons/amxmodx/configs/night_mode.cfg</li>
  </ul>
  <h3 id="section-8">1.5.0 (15 фев 2023г):</h3>
  <h4 id="section-9">Добавлено:</h4>
  <ul>
    <li>добавлена возможность в 'night_mode.ini' указывать не только часы и минуты, но<br />
      и даты</li>
    <li>добавлен квар nm_start_end_hud_msg, который отвечает за RGB цвет, XY координаты<br />
      и продолжительность HUD сообщения старта и конца ночного режима</li>
  </ul>
  <h4 id="section-10">Изменено:</h4>
  <ul>
    <li>глобальный рефакторинг кода</li>
    <li>переработаны debug логи</li>
    <li>квар nm_changelevel_type переименован в nm_stop_interval_type</li>
    <li>в 'night_mode.ini' расширено описание связанное с указанием дней недели и времени</li>
    <li>описание команды nm_load_plugin расширено и перенесено в 'night_mode_start.cfg'</li>
    <li>конфигурационный файл night_mode_end.cfg переименован в night_mode_stop.cfg,<br />
      чтобы при сортировке файлов по имени night_mode_start.cfg шел первым</li>
  </ul>
  <h4 id="section-11">Исправлено:</h4>
  <ul>
    <li>не все ключи словаря можно было комментировать с целью отключения HUD сообщения</li>
    <li>исправлено обновление mp_timelimit при sv_restart и sv_restartround</li>
  </ul>
  <h4 id="section-12">Удалено:</h4>
  <ul>
    <li>удален квар nm_start_cfg_exec_delay</li>
  </ul>
  <h4 id="section-13">Обновившиеся файлы:</h4>
  <ul>
    <li>addons/amxmodx/plugins/night_mode.amxx</li>
    <li>addons/amxmodx/configs/night_mode.cfg</li>
    <li>addons/amxmodx/configs/night_mode.ini</li>
    <li>addons/amxmodx/configs/night_mode_start.cfg</li>
    <li>addons/amxmodx/data/lang/night_mode.txt</li>
  </ul>
  <h3 id="section-14">1.4.1 (29 мая 2022г):</h3>
  <h4 id="section-15">Добавлено:</h4>
  <ul>
    <li>добавлен квар nm_changelevel_type, отвечающий за тип смены карты.
      <ul>
        <li>0 - сразу как наступило время</li>
        <li>1 - дождаться начала следующего раунда</li>
      </ul>
    </li>
  </ul>
  <h4 id="section-16">Исправлено:</h4>
  <ul>
    <li>лог 'Invalid week day string' отображался в обычных логах, хотя должен был<br />
      отображаться только при nm_debug_level 2</li>
  </ul>
  <h4 id="section-17">Обновившиеся файлы:</h4>
  <ul>
    <li>addons/amxmodx/plugins/night_mode.amxx</li>
    <li>addons/amxmodx/configs/night_mode.cfg</li>
  </ul>
  <h3 id="section-18">1.3.0 (19 апр 2021г):</h3>
  <h4 id="section-19">Добавлено:</h4>
  <ul>
    <li>добавлена forward функция 'night_mode_event(event_id)', которая вызывается<br />
      (на данный момент) когда начинается и заканчивается ночной режим</li>
    <li>доп значение для native функции nm_get_night_mode_status. Значение 2, означает<br />
      что ночной режим под управлением менеджера карт (ключевое слово unknown в<br />
      night_mode.ini)</li>
  </ul>
  <h4 id="section-20">Изменено:</h4>
  <ul>
    <li>изменен код под внешнее ядро плагинов (plugins_core.amxx)</li>
    <li>изменяет код для лучшей совместимости с All Inclusive</li>
    <li>поправлено положение информера для разрешения 640x480</li>
    <li>часть дебаг логов переведена в статус обычных, так как они информировали<br />
      о нештатных ситуациях</li>
    <li>больше не ставится на паузу если плохая карта (только дебаг лог)</li>
  </ul>
  <h4 id="section-21">Обновившиеся файлы:</h4>
  <ul>
    <li>addons/amxmodx/plugins/night_mode.amxx</li>
    <li>addons/amxmodx/configs/night_mode.cfg</li>
    <li>addons/amxmodx/configs/night_mode_start.cfg</li>
    <li>addons/amxmodx/configs/night_mode_end.cfg</li>
    <li>addons/amxmodx/data/lang/night_mode.txt</li>
  </ul>
  <h3 id="section-22">Версия 1.2.3 (13 мар 2018г):</h3>
  <h4 id="section-23">Добавлено:</h4>
  <ul>
    <li>добавлен форварды 'nm_night_mode_enabled' (включение) и 'nm_night_mode_disabled'<br />
      (выключение), которые вызываются при включении и отключении ночного режима</li>
    <li>добавлена native функция nm_get_night_mode_status, которая позволяет получить<br />
      текущий статус ночного режима. 1 - включено, 0 - выключено</li>
  </ul>
  <h4 id="section-24">Исправлено:</h4>
  <ul>
    <li>исправлен недочет: при определенном стечении обстоятельств mp_timelimit<br />
      округлялся неправильно, что приводило к постоянному его уменьшению</li>
    <li>исправлен недочет: не менялась карта после создания файла со списком плагинов<br />
      загружаемых через Night Mode</li>
  </ul>
  <h3 id="section-25">Версия 1.2.0 (31 янв 2018г):</h3>
  <h4 id="section-26">Добавлено:</h4>
  <ul>
    <li>добавлена возможность указывать день недели либо в виде диапазона (1-7),<br />
      либо перечислением (1,2,3 и т.д) в night_mode.ini<br />
      Внимание: нужно обновить (удалить чтобы создался новый) файл<br />
      'addons/amxmodx/configs/night_mode.ini'</li>
    <li>добавлен квар nm_start_cfg_exec_delay, который задает задержку загрузки<br />
      конфигурационного файла, запускаемого при старте ночного режима</li>
    <li>добавлено оповещение в чате при попытке использовать заблокированную команду</li>
    <li>добавлена возможность работы ночного режима без указания карт. Для этого вместо<br />
      названия карты указывается слово 'unknown' (с англ. неизвестно), время начала<br />
      и конца ночного режима. При этом время карты и её смена не блокируется и<br />
      проходит под управлением текущего менеджера карт</li>
  </ul>
  <h4 id="section-27">Изменено:</h4>
  <ul>
    <li>HUD сообщение о включении ночного режима, теперь показывается с задержкой в<br />
      nm_start_cfg_exec_delay секунд</li>
    <li>плагин теперь может либо на время включать CSDM режим, либо все время работать<br />
      в нем. Для включения и выключения, прописываются команды csdm_enable<br />
      в стартовый и csdm_disable (если нужно отключить CSDM) в конечный конфиг</li>
    <li>версии для классических серверов и для CSDM режима, теперь в одном плагине.<br />
      Модули CSDM и RoundControl не подгружаются автоматически, необходимо их<br />
      прописывать в modules.ini, если используется CSDM режим</li>
  </ul>
  <h4 id="section-28">Исправлено:</h4>
  <ul>
    <li>исправлен недочет: неправильный расчет времени при определенных условиях,<br />
      в результате чего ночной режим мог выключиться (багрепорт Bullseye)</li>
    <li>устранен недочет: если время начала больше времени конца при некотором стечении<br />
      обстоятельств, время рассчитывалось для следующих суток и ночной режим не включался</li>
  </ul>
  <h3 id="section-29">Версия 1.1.0 (15 июн 2017г):</h3>
  <h4 id="section-30">Добавлено:</h4>
  <ul>
    <li>добавлено автоматическое создание конфигурационного файла night_mode.ini</li>
    <li>добавлено автоматическое создание конфигурационных файлов, которые будут<br />
      выполняются в начале и конце ночного режима</li>
    <li>добавлена команда nm_load_plugin, определяющая какие плагины будут загружены</li>
    <li>добавлен квар nm_hud_informer_delay, отвечающий за время (в секундах),<br />
      через которое будет показываться информер</li>
    <li>добавлен квар nm_hud_informer_show_time, определяет сколько времени<br />
      (в секундах) будет показываться информер</li>
  </ul>
  <h4 id="section-31">Исправлено:</h4>
  <ul>
    <li>устранен недочет: наложение информеров в результате чего цвет был ярче</li>
  </ul>
  <h4 id="section-32">Удалено:</h4>
  <ul>
    <li>удален код блокирующий запуск плагина на ReHLDS серверах, но не проверялась<br />
      работоспособность</li>
  </ul>
  <h3 id="section-33">Версия 1.0.3 (07 дек 2016г):</h3>
  <ul>
    <li>добавлена консольная команда nm_block_cmd, которая вносит команду, указанную<br />
      в качества аргумента, в список блокируемых на время ночного режима</li>
    <li>добавлена блокировка изменения кваров влияющих на работу ночного режима</li>
    <li>добавлена возможность отключения любых сообщений с помощью комментирования в<br />
      night_mode.txt ('//' или ';')</li>
  </ul>
</body>

</html>